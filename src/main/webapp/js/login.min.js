$(function(){$(document).keydown(function(f){if(f.keyCode===13){$("#login").click()}});$("#login").click(function(){var f=$("#password").val();var h=$("#userName").val();if(e(f)||e(h)){a("用户名或者密码为空");return}b();var g={};g.kid=$("#kid").val();g.token=$("#token").val();g.userName=h;console.log(g);d("/getTicket",g,function(i,p){var n=i.ticket;var k=CryptoJS.enc.Utf8.parse(n);var m=CryptoJS.enc.Utf8.parse(f);var j=CryptoJS.AES.encrypt(m,k,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});var o=j.toString();var l={userName:h,kid:g.kid,pw:o,token:g.token,ticket:n};console.log(l);d("/auth",l,function(q,r){console.log(q);console.log(r);if(q.resultCode!=="000000"){c();$("#password").val("");a(q.resultMsg);return}})})});function d(g,i,h){$.ajax({url:Service.servePath+g,type:"POST",async:true,data:JSON.stringify(i),cache:false,success:function(f,j){h(f,j)}})}function b(){$("#loginBox").css("display","none");$("#loading").css("display","block")}function c(){$("#loginBox").css("display","block");$("#loading").css("display","none")}function a(f){$("#msg").text(f);$("ul").slideToggle();setTimeout(function(){$("ul").slideToggle();$("#msg").text("")},2000)}function e(f){if(typeof f=="undefined"||f==null||f==""){return true}else{return false}}});