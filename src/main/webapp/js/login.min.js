$(function(){function d(o,e,n){$.ajax({url:Service.servePath+o,type:"POST",async:!1,data:JSON.stringify(e),cache:!1,success:function(o,e){n(o,e)}})}function u(o){$("#msg").text(o),$("ul").slideToggle(),setTimeout(function(){$("ul").slideToggle(),$("#msg").text("")},2e3)}function o(o){return void 0===o||null==o||""==o}$("#userName").val("joka"),$("#password").val("dominjoka0502"),$(document).keydown(function(o){13===o.keyCode&&$("#login").click()}),$("#login").click(function(){var c=$("#password").val(),a=$("#userName").val();if(o(c)||o(a))u("用户名或者密码为空");else{$("#loginBox").css("display","none"),$("#loading").css("display","block");var r={};r.kid=$("#kid").val(),r.token=$("#token").val(),r.userName=a,console.log(r),d("/getTicket",r,function(o,e){var n=o.ticket,t=CryptoJS.enc.Utf8.parse(n),s=CryptoJS.enc.Utf8.parse(c),i=CryptoJS.AES.encrypt(s,t,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7}).toString(),l={userName:a,kid:r.kid,pw:i,token:r.token,ticket:n};console.log(l),d("/auth",l,function(o,e){if(console.log(o),console.log(e),"000000"!==o.resultCode)return $("#loginBox").css("display","block"),$("#loading").css("display","none"),$("#password").val(""),void u(o.resultMsg);window.location.href=o.resultMsg})})}})});